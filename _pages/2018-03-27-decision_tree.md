---
layout: page
title:  "–†–µ—à–∞—é—â–∏–µ –¥–µ—Ä–µ–≤—å—è"
date:   2018-03-27 21:07:26 +0600
navigation: 43
---

# –†–µ—à–∞—é—â–∏–µ –¥–µ—Ä–µ–≤—å—è

_–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –∏–∑—É—á–µ–Ω–∏–µ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã_ üòÆ

[–†–µ—à–∞—é—â–∏–µ –¥–µ—Ä–µ–≤—å—è - —Å—Ç—Ä–æ–≥–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ](https://github.com/esokolov/ml-course-msu/blob/master/ML15/lecture-notes/Sem04_trees.pdf)

[–ü–æ–ø—É–ª—è—Ä–Ω–æ —Å –ø—Ä–∏–º–µ—Ä–æ–º –∫–æ–¥–∞](https://habrahabr.ru/company/ods/blog/322534/#derevo-resheniy)

[–ó–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π –∏–∑ –∫—É—Ä—Å–∞ –ú–ì–£](https://github.com/esokolov/ml-course-hse/blob/master/2016-fall/homeworks-practice/homework-practice-03-ensembles.ipynb)

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ:

[–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è](https://github.com/esokolov/ml-course-msu/blob/master/ML15/lecture-notes/Sem01_intro.pdf)

## –î–µ—Ä–µ–≤—å—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π (Decision Tree)

–î–µ—Ä–µ–≤—å—è –±—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ - —á–µ—Ä–Ω—ã–π, –±–µ–ª—ã–µ, –∫—Ä–∞—Å–Ω—ã–µ. –ò –≤—Å–µ –∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—á–µ—Ç—Å—è –∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å. –ù–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —Ä–µ–∑–æ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å - –∞ –≥–¥–µ –∂–µ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –∑–∞—á–µ–º –æ–Ω–∏ –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã? –ú—ã —Å –≤–∞–º–∏ —É–∂–µ –±–µ–≥–ª–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å –æ–±—ã—á–Ω—ã–º –±–∏–Ω–∞—Ä–Ω—ã–º –¥–µ—Ä–µ–≤–æ–º –ø–æ–∏—Å–∫–∞, –∫–æ–≥–¥–∞ –ø–∏—Å–∞–ª–∏ —Å–≤–æ—ë –º–Ω–æ–∂–µ—Å—Ç–≤–æ (Set), —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –ø—Ä–∏—á–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. –î–∞–ª—å–Ω–µ–π—à–∏–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º –∏–¥–µ–∏ –º–æ–≥ –±—ã —Å—Ç–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å (Ductionary, Map). –î–ª—è –µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞–º –±—ã —Å—Ç–æ–∏–ª–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö 2-3-–¥–µ—Ä–µ–≤–æ –∏–ª–∏ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.

–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –∫–∞–∫ –≤—ã —É–∂–µ –ø–æ–Ω—è–ª–∏, –¥–µ—Ä–µ–≤—å—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–∫–æ–≥–æ-—Ç–æ –ø–æ—Ä—è–¥–∫–∞ (–º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å –ø–æ–º–æ—â—å—é –¥–µ—Ä–µ–≤—å–µ–≤). –ò –µ—Å–ª–∏ —Ä–∞–∑–≤–∏—Ç—å —ç—Ç—É –∏–¥–µ—é –¥–∞–ª—å—à–µ, —Ç–æ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –±—É–¥–µ–º –≤ –¥–µ—Ä–µ–≤–µ –∏—Å–∫–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–ø—É—Å—Ç–∏–º—Å—è –∫ –ª–∏—Å—Ç—å—è–º - –æ—Ç–≤–µ—Ç–∞–º.

–ù–∞ —ç—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ –º—ã –±—É–¥–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ —É–∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–µ–º–µ–π—Å—Ç–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞—à–µ –¥–µ—Ä–µ–≤–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–≤–æ–µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –±—É–¥–µ—Ç —É—á–∏—Ç—å—Å—è –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –∏ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –¢–æ –µ—Å—Ç—å –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –æ–Ω–æ –∂–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞!

### –ù–µ–±–æ–ª—å—à–∞—è —Ç–µ–æ—Ä–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

–ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π —É–¥–æ–±–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã, –≥–¥–µ –≤ —Å—Ç—Ä–æ–∫–∞—Ö - –æ–±—ä–µ–∫—Ç—ã.

|–†–æ—Å—Ç|–í–µ—Å|–ì–µ–Ω–¥–µ—Ä|
|----|---|------|
|180|75|–ú|
|168|50|–ñ|
|175|60|–ú|
|190|70|–ñ|

`–†–æ—Å—Ç`, `–í–µ—Å`, `–ì–µ–Ω–¥–µ—Ä` –Ω–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ–ª–∞ —á–µ–ª–æ–≤–µ–∫–∞ –ø–æ –µ–≥–æ –≤–µ—Å—É –∏ —Ä–æ—Å—Ç—É, —Ç–æ–≥–¥–∞ –º—ã –±—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ `–†–æ—Å—Ç`, `–í–µ—Å` - —ç—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ $X$, –∞ `–ì–µ–Ω–¥–µ—Ä` - —ç—Ç–æ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫(–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è) $Y$.

–ó–∞–¥–∞—á–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è - —ç—Ç–æ –Ω–∞–π—Ç–∏ –Ω–µ–∫–æ—Ç–æ—Ä—É—é —Ñ—É–Ω–∫—Ü–∏—é f, —á—Ç–æ $f(X) -> Y$. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ $f$ - —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–π "–∑–∞–∫–æ–Ω –ø—Ä–∏—Ä–æ–¥—ã", –∫–æ—Ç–æ—Ä—ã–π –º—ã –º–æ–∂–µ–º –∏–∑—É—á–∏—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∏–¥–µ–ª–∏.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞ –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –æ –≤—ã–∂–∏–≤—à–∏—Ö –Ω–∞ –¢–∏—Ç–∞–Ω–∏–∫–µ.

![—Ç–∏—Ç–∞–Ω–∏–∫](https://upload.wikimedia.org/wikipedia/commons/f/f3/CART_tree_titanic_survivors.png)

–ö–∞–∫ –º—ã –≤–∏–¥–∏–º –≤ —É–∑–ª–∞—Ö –∑–∞–¥–∞—é—Ç—Å—è –≤–æ–ø—Ä–æ—Å—ã –∫ –æ–±—ä–µ–∫—Ç–∞–º –ø–æ –∫–∞–∫–æ–º—É-—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫—É. –ê –≤ –ª–∏—Å—Ç—å—è—Ö –æ—Ç–≤–µ—Ç—ã - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.

–ù–æ –∫–∞–∫ –ø–æ –±–æ–ª—å—à–æ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–¥–Ω–æ –¥–µ—Ä–µ–≤–æ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–æ –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–æ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é?

### –ê–ª–≥–æ—Ä–∏—Ç–º

–ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è –¥–µ—Ä–µ–≤—å–µ–≤ –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ —Ä–∞–∑–±–∏–≤–∞—é—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞–ø–æ–ø–æ–ª–∞–º - –ª–µ–≤–æ–µ –∏ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –í –¥–µ—Ä–µ–≤–µ –ø–æ–∏—Å–∫–∞ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–ª–∏ –∫—É–¥–∞ –ø–æ–π—Ç–∏ –¥–∞–ª—å—à–µ, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Å –∫–æ—Ä–Ω–µ–º –∏ –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –±–æ–ª—å—à–µ, —Ç–æ –∏–¥–µ–º –≤ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ, –∏–Ω–∞—á–µ - –≤ –ª–µ–≤–æ–µ. –ù–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –≤—Å—é –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É –≤ –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞. –í–æ –ø–µ—Ä–≤—ã—Ö - –æ–±—ä–µ–∫—Ç—ã —Å–∞–º–∏ –ø–æ —Å–µ–±–µ –Ω–µ —Å—Ä–∞–≤–Ω–∏–º—ã, —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –í —É–∑–ª–∞—Ö –º—ã –±—É–¥–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏. –í–æ –≤—Ç–æ—Ä—ã—Ö - –¥–µ—Ä–µ–≤–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å –±—ã –æ–≥—Ä–æ–º–Ω—ã–º, –¥–∞ –∏ –º—ã –Ω–µ —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É –ø–æ–∏—Å–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –º—ã —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –¥–µ—Ä–µ–≤–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º —Å–≤–æ–µ–º —É–∑–ª–µ –¥–µ–ª–∏—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ 2 —á–∞—Å—Ç–∏ –ø–æ _–æ–¥–Ω–æ–º—É –∫–∞–∫–æ–º—É-—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫—É_ —Å —Ü–µ–ª—å—é –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –≠—Ç–æ –∫–∞–∫ –ê–∫–∏–Ω–∞—Ç–æ—Ä!

> –ù–∞ –∫–∞–∂–¥–æ–º —Å–≤–æ—ë–º —à–∞–≥–µ –∞–ª–≥–æ—Ä–∏—Ç–º –∏—â–µ—Ç _–Ω–∞–∏–ª—É—á—à–µ–µ_, –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Å–º—ã—Å–ª–µ, —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ 2 —á–∞—Å—Ç–∏.

–ß—Ç–æ –∑–Ω–∞—á–∏—Ç _–∏—â–µ—Ç_? –ó–Ω–∞—á–∏—Ç, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –≤—Å–µ–º –∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞–º (O(n^2)), –≤—ã—á–∏—Å–ª—è–µ—Ç _–∫–∞—á–µ—Å—Ç–≤–æ_ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è –∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ _–∫–∞—á–µ—Å—Ç–≤–æ_ –Ω–∞–∏–ª—É—á—à–µ–µ.

**–†–∞–∑–±–∏–µ–Ω–∏–µ**

```
–ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É:
    –ø–æ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É –≤—ã–±–æ—Ä–∫–∏:
        –≤—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ 2 —á–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—è –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç[–ø—Ä–∏–∑–Ω–∞–∫].
        –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–∞—á–µ—Å—Ç–≤–∞
–≤–µ—Ä–Ω—É—Ç—å –ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ
```

–ß—Ç–æ —Ç–∞–∫–æ–µ _–∫–∞—á–µ—Å—Ç–≤–æ_ —Ä–∞–∑–±–∏–µ–Ω–∏—è? –≠—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è –º–µ—Ç—Ä–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –¥–≤–∞ –º–∞—Å—Å–∏–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤, –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–∞–∫–æ–µ-—Ç–æ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ —á–µ–º –±–æ–ª—å—à–µ —Ç–µ–º –ª—É—á—à–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å –¥–∞–Ω–∞ –≤—ã–±–æ—Ä–∫–∞ –∂–∏—Ä–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –∏ –Ω–µ—Ç —á–∏—Å–µ–ª [**1**,**2**,**3**,4,5,6,7], –º—ã —Å–æ–∑–¥–∞–µ–º 2 —Ä–∞–∑–±–∏–µ–Ω–∏—è [**1**] –∏ [**2**,**3**,4,5,6,7], —Ç–æ –º—ã –≥–æ–≤–æ—Ä–∏–º, —á—Ç–æ –æ–Ω–æ –£–∂–∞—Å–Ω–æ –ø–ª–æ—Ö–æ–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω–∞–¥–æ –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞. –ê —Ä–∞–∑–±–∏–µ–Ω–∏–µ [**1**,**2**,**3**],[4,5,6,7] - –∏–¥–µ–∞–ª—å–Ω–æ–µ! –ü–æ—á–µ–º—É –º—ã –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ —É –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è —Ö—É–∂–µ? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤–∑—è–ª –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ –ø—Ä–∞–≤–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ.

> –≠—Ç–æ –∫–∞–∫ –µ—Å–ª–∏ –≤ –∏–≥—Ä–µ –ê–∫–∏–Ω–∞—Ç–æ—Ä –±—ã –ø–µ—Ä–µ–±–∏—Ä–∞–ª –≤—Å–µ—Ö –∞–∫—Ç–µ—Ä–æ–≤, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç –∏ —Å—Ç—Ä–∞–Ω—É –¥–ª—è –Ω–∞—á–∞–ª–∞, —Ç–µ–º —Å–∞–º—ã–º —É–º–µ–Ω—å—à–∏–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º –≤–¥–≤–æ–µ.

–ù–∞–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞. –ü–æ—Å—á–∏—Ç–∞–µ–º –¥–æ–ª—é –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ –ª–µ–≤–æ–º –∏ –ø—Ä–∞–≤–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏ (–ø–æ —Å—É—Ç–∏ - —ç—Ç–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ —ç—Ç–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ). –ü–æ—Å—á–∏—Ç–∞–µ–º –≤ –ª–æ–± –¥–ª—è left=[**1**] –∏ right=[**2**,**3**,4,5,6,7]. `p(bold_class, left) == 1.0`, `p(regular_class, left) == 0.0`, `p(bold_class, right) == 2/6=0.33`, `p(regular_class, left) == 0.67`. –£ –Ω–∞—Å –µ—Å—Ç—å –ø–æ –¥–≤–∞ —á–∏—Å–ª–∞, –Ω–æ –Ω—É–∂–Ω–æ –æ–¥–Ω–æ —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≥–¥–µ –ª—É—á—à–µ! –ú–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ `1.0 ** 2 + 0.0**2 + 0.33**2 + 0.67**2 == 1.5578`. –î–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è, –≥–¥–µ —É –Ω–∞—Å –≤—Å—ë –∏–¥–µ–∞–ª—å–Ω–æ, –∫–∞—á–µ—Å—Ç–≤–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ `2`. –ù–∞–∏—Ö—É–¥—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –¥–∞—Å—Ç `0.5**2 + 0.5**2 + 0.5**2 + 0.5**2 == 1`.

**–ö—Ä–∏—Ç–µ—Ä–∏–π –∫–∞—á–µ—Å—Ç–≤–∞ [Gini](https://en.wikipedia.org/wiki/Decision_tree_learning#Gini_impurity)**

–£–ª—É—á—à–∏–º –Ω–∞–∏–≤–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π. –î–ª—è —ç—Ç–æ–≥–æ –≤—Å–µ–≥–æ –ª–∏—à—å –¥–æ–±–∞–≤–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤. –ù–æ —Ç–æ–≥–¥–∞ –ª—É—á—à–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–∞—Å—Ç 0. –ê —á–µ–º —Ö—É–∂–µ, —Ç–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞.

```
–î–ª—è –ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è:
    –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞:
        p = —Å—á–∏—Ç–∞–µ–º –¥–æ–ª–∏ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏)
        score += p**2
    –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:
        gini += (1-score) * (—Ä–∞–∑–º–µ—Ä —ç—Ç–æ–π –≥—Ä—É–ø–ø—ã / –≤—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ª–µ–≤–æ–º –∏ –ø—Ä–∞–≤–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏)
return gini
```

–ò—Ç–∞–∫ –º—ã —É–º–µ–µ–º –≤—ã–±–∏—Ä–∞—Ç—å –ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏. –¢–æ –µ—Å—Ç—å –º—ã —É–º–µ–µ–º –≤—ã–±–∏—Ä–∞—Ç—å 1 —É–∑–µ–ª –∏ 2 –ª–∏—Å—Ç–∞. –ù–æ –Ω–∞–º –Ω—É–∂–Ω–æ –∂–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–ª–æ–µ –¥–µ—Ä–µ–≤–æ. ??? . –ü—Ä–∞–≤–∏–ª—å–Ω–æ, —Å—Ç—Ä–æ–∏–º –¥–∞–ª—å—à–µ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–æ —Ç–µ—Ö –ø–æ—Ä –ø–æ–∫–∞ **–Ω—É–∂–Ω–æ**.

–ö–æ–≥–¥–∞ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è? –ü–µ—Ä–≤–æ–µ –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ - –∫–æ–≥–¥–∞ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –≤ –ª–∏—Å—Ç–µ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞. –ü–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∑–∞—Ç—å - –≤—Å—ë, –µ—Å–ª–∏ —Å—é–¥–∞ –∑–∞–±—Ä–µ–ª–∏, —Ç–æ —Ç—É—Ç –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ –ê. –í –ø—Ä–∏–Ω—Ü–∏–ø–µ –Ω–∞–º —ç—Ç–æ–≥–æ —É—Å–ª–æ–≤–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–õ—É—á—à–µ –≤—Å–µ–≥–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –∫–ª–∞—Å—Å - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞—à–µ–≥–æ –æ–±—É—á–µ–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞. –ó–∞–¥–∞–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –æ–Ω –Ω–∞–º –µ—â–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:

```python
class DecisionTree:
    def fit(X, y):
        # —Ç—É—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏
        pass

    def predict(X):
        # —Ç—É—Ç –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        pass

    def visualise():
        # –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –¥–µ—Ä–µ–≤–æ –≤–Ω—É—Ç—Ä–∏ –ø–æ—Å—Ç—Ä–æ–∏–ª–æ—Å—å
        pass
```

–¢–µ—Å—Ç—ã –ø–∏—Å–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ! –ù–∞ –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ - –Ω–∞ —Ä–∞–∑–±–∏–µ–Ω–∏–µ, –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–±–∏–µ–Ω–∏–µ, –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–±–∏–µ–Ω–∏—è.

#### –î–∞ –∫–∞–∫ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ?

**–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏**

1. –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏
    1. –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏(—Å—Ç–æ–ª–±—Ü—ã) –∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã(—Å—Ç—Ä–æ–∫–∏)
        1. –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –≤ –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∏ —Å—Ç–æ–ª–±—Ü–µ
        2. –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è
        3. –≤—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ
    2. –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
        - –µ—Å–ª–∏ —Ç–∞–º –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞(Y), —Ç–æ–≥–¥–∞ —ç—Ç–æ –∫–æ–Ω—Ü–µ
        - –∏–Ω–∞—á–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤—ã–±–∏—Ä–∞–µ–º –Ω–∞–∏–ª—É—á—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ

–í –ª–∏—Å—Ç—å—è—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤, –≤ –ø—Ä–æ—Å—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ 0 –∏ 1.

–í —É–∑–ª–∞—Ö –¥–µ—Ä–µ–≤–∞ - —É—Å–ª–æ–≤–∏–µ –≤–∏–¥–∞ _–ü—Ä–∏–∑–Ω–∞–∫_i < –ó–Ω–∞—á–µ–Ω–∏—è_, –Ω–∞–ø—Ä–∏–º–µ—Ä, `x['–†–æ—Å—Ç'] < 170`.

**–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ**

–°–ø—É—Å–∫–∞–µ–º—Å—è –æ–±—ä–µ–∫—Ç–æ–º –ø–æ –¥–µ—Ä–µ–≤—É –≤–Ω–∏–∑, –ø—Ä–∏–º–µ–Ω—è—è —É—Å–ª–æ–≤–∏—è –∏–∑ —É–∑–ª–æ–≤ –¥–µ—Ä–µ–≤–∞ –∫ –æ–±—ä–µ–∫—Ç—É, –¥–æ –ª–∏—Å—Ç–∞ - —Å–∞–º–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–ù–∞—Å—Ç–∞–ª–æ –≤—Ä–µ–º—è –Ω–∞—É—á–∏—Ç—å –Ω–∞—à–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —á—Ç–æ-–Ω–∏–±—É–¥—å. –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã: [–¢–∏—Ç–∞–Ω–∏–∫](https://www.kaggle.com/c/titanic/data), [–±–∞–Ω–∫–Ω–æ—Ç—ã](http://archive.ics.uci.edu/ml/datasets/banknote+authentication), [–∏—Ä–∏—Å—ã](http://archive.ics.uci.edu/ml/datasets/Iris).

–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ –Ω–∞—à–µ –¥–µ—Ä–µ–≤–æ —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π –º—ã –±—É–¥–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—É—é –º–µ—Ç—Ä–∏–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ - –¥–æ–ª—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤(accuracy). –ï—Å—Ç—å –µ—â–µ –º–µ—Ç—Ä–∏–∫–∞ F1, –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ —Ä–æ–¥–∞, –Ω–æ –º–æ–∂–Ω–æ –∏ –±–µ–∑ –Ω–µ—ë.

### Hints

- pandas - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ csv
- numpy - —á–∏—Å–ª–µ–Ω–Ω—ã–π –ø–∏—Ç–æ–Ω - –±—ã—Å—Ç—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞–¥ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏
- matplotlib, Seaborn - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- scipy - —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- sklearn - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞

- [wiki](https://ru.wikipedia.org/wiki/–î–µ—Ä–µ–≤–æ_–ø—Ä–∏–Ω—è—Ç–∏—è_—Ä–µ—à–µ–Ω–∏–π)
- [–≠–Ω—Ç—Ä–æ–ø–∏—è –∏ –¥–µ—Ä–µ–≤—å—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π](https://habrahabr.ru/post/171759/)
- [–£—á–µ–±–Ω–∏–∫ –í–æ—Ä–æ–Ω—Ü–æ–≤–∞ –ø–æ ML](http://www.machinelearning.ru/wiki/images/3/3e/Voron-ML-Logic.pdf)

![](https://media.alienwarearena.com/media/depression-meme.jpg)
